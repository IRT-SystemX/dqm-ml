

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tests of Completeness, Representtiveness &mdash; DQM 1.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=fc837d61"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            DQM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../guidelines.html">üí° Guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../completeness.html">üçä Completeness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../diversity.html">üçé Diversity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../domain_gap.html">üçã Domain gap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../representativeness.html">üçì Representativeness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">üîÑ Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dqm.html">üé° Package dqm</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DQM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tests of Completeness, Representtiveness</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/multiple_metrics_tests.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Tests-of-Completeness,-Representtiveness">
<h1>Tests of Completeness, Representtiveness<a class="headerlink" href="#Tests-of-Completeness,-Representtiveness" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common Libraries</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">dqm</span>
</pre></div>
</div>
</div>
<section id="Tests-on-challenge-welding-data">
<h2>Tests on challenge welding data<a class="headerlink" href="#Tests-on-challenge-welding-data" title="Link to this heading">ÔÉÅ</a></h2>
<p>This dataset is described on the website of challenge welding : <a class="reference external" href="https://confianceai.github.io/Welding-Quality-Detection-Challenge/">https://confianceai.github.io/Welding-Quality-Detection-Challenge/</a></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># upload data</span>
<span class="c1"># Dataset path</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;datasets/challenge_welding.csv&quot;</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="c1">#print(&quot;Data info:\n&quot;, data.info())</span>
<span class="c1"># print(&quot;The first 5 lines:\n&quot;, data.head())</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sample_id</th>
      <th>class</th>
      <th>timestamp</th>
      <th>welding-seams</th>
      <th>labelling_type</th>
      <th>resolution</th>
      <th>path</th>
      <th>sha256</th>
      <th>storage_type</th>
      <th>data_origin</th>
      <th>blur_level</th>
      <th>blur_class</th>
      <th>luminosity_level</th>
      <th>external_path</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>data_37966</td>
      <td>OK</td>
      <td>08/07/2022 02:05</td>
      <td>c33</td>
      <td>operator</td>
      <td>[960 540]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'0F\\\x12\xa1\x81\xcdL\xc3~\xbe\x03\xc90\x91\...</td>
      <td>s3</td>
      <td>real</td>
      <td>1667.425860</td>
      <td>clean</td>
      <td>51.079433</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>data_25403</td>
      <td>OK</td>
      <td>19/07/2022 00:51</td>
      <td>c102</td>
      <td>operator</td>
      <td>[960 540]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'\tlM\xd7\x83\\\x7fm\xaeV\xc6\xbd\xd6S@\x17S\...</td>
      <td>s3</td>
      <td>real</td>
      <td>868.574712</td>
      <td>blur</td>
      <td>32.825601</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>data_27038</td>
      <td>OK</td>
      <td>28/07/2022 16:08</td>
      <td>c102</td>
      <td>operator</td>
      <td>[960 540]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'\xeb\xba/\xe0-\xe6\x14\xd6\xe0\xf2oT\xd1\xa9...</td>
      <td>s3</td>
      <td>real</td>
      <td>1078.402671</td>
      <td>clean</td>
      <td>35.192525</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>data_8767</td>
      <td>OK</td>
      <td>31/01/20 09:41</td>
      <td>c33</td>
      <td>expert</td>
      <td>[1920 1080]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b"\x9e@!\xd3\xdd\xaa'\xb7]\xeb\xf7B\x800\xf1\x...</td>
      <td>s3</td>
      <td>real</td>
      <td>1240.198851</td>
      <td>clean</td>
      <td>38.510588</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>data_4744</td>
      <td>OK</td>
      <td>25/11/19 21:57</td>
      <td>c20</td>
      <td>expert</td>
      <td>[1920 1080]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'\x0c\xd8\xcfb\x95\\\xb9\xa8w\xe7^\xea\rX,8\x...</td>
      <td>s3</td>
      <td>real</td>
      <td>3371.897144</td>
      <td>clean</td>
      <td>46.001366</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>22748</th>
      <td>data_66456</td>
      <td>OK</td>
      <td>29/10/19 01:33</td>
      <td>c102</td>
      <td>expert</td>
      <td>[1920 1080]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'\x9fZ^\xc5j\xf1\xd8JRw\x03\xa4C\x04\xa6\xa1\...</td>
      <td>s3</td>
      <td>real</td>
      <td>4463.079210</td>
      <td>clean</td>
      <td>41.554284</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>22749</th>
      <td>data_24294</td>
      <td>OK</td>
      <td>07/07/2022 01:40</td>
      <td>c102</td>
      <td>operator</td>
      <td>[960 540]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'\x05\x07x\xa4\xb8\x01\xf1a\x18.\x13\xe4\xe6\...</td>
      <td>s3</td>
      <td>real</td>
      <td>859.194594</td>
      <td>blur</td>
      <td>31.966749</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>22750</th>
      <td>data_25568</td>
      <td>OK</td>
      <td>19/07/2022 11:59</td>
      <td>c102</td>
      <td>operator</td>
      <td>[960 540]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'O\x0eT\xa1\x8b\xa0\xf5\xaei\x81\xe8\x16\x96p...</td>
      <td>s3</td>
      <td>real</td>
      <td>977.316444</td>
      <td>clean</td>
      <td>40.872106</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>22751</th>
      <td>data_39356</td>
      <td>OK</td>
      <td>13/07/2022 06:45</td>
      <td>c33</td>
      <td>operator</td>
      <td>[960 540]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'\x1bh\xd9\x8aK\x88\xc1\xcb\xea\xff\xe3]{\x0e...</td>
      <td>s3</td>
      <td>real</td>
      <td>1653.447154</td>
      <td>clean</td>
      <td>50.429395</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
    <tr>
      <th>22752</th>
      <td>data_8988</td>
      <td>OK</td>
      <td>09/03/20 12:22</td>
      <td>c33</td>
      <td>expert</td>
      <td>[1920 1080]</td>
      <td>challenge-welding/datasets/welding-detection-c...</td>
      <td>b'\xce\x0e\x87\xd7\x9b\x8d\xc4\x10[\xe9\x8fl\x...</td>
      <td>s3</td>
      <td>real</td>
      <td>593.528212</td>
      <td>blur</td>
      <td>39.343171</td>
      <td>http://minio-storage.apps.confianceai-public.i...</td>
    </tr>
  </tbody>
</table>
<p>22753 rows √ó 14 columns</p>
</div></div>
</div>
</section>
</section>
<section id="Completeness">
<h1>Completeness<a class="headerlink" href="#Completeness" title="Link to this heading">ÔÉÅ</a></h1>
<p>you can see also the file: <em>dqm/completeness/main.py</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Specific Libraries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dqm.completeness.metric</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataCompleteness</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute completeness on the whole dataset</span>
<span class="n">completeness_evaluator</span> <span class="o">=</span> <span class="n">DataCompleteness</span><span class="p">()</span>
<span class="n">overall_score</span> <span class="o">=</span> <span class="n">completeness_evaluator</span><span class="o">.</span><span class="n">completeness_tabular</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">overall_score</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute completeness on a single column</span>
<span class="n">column_score</span> <span class="o">=</span> <span class="n">completeness_evaluator</span><span class="o">.</span><span class="n">data_completion</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;blur_level&#39;</span><span class="p">])</span>

<span class="c1"># Print the results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Overall Data Completeness Score: </span><span class="si">{</span><span class="n">overall_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Completeness Score for Column: </span><span class="si">{</span><span class="n">column_score</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overall Data Completeness Score: 1.0
Completeness Score for Column: 1
</pre></div></div>
</div>
</section>
<section id="Representativeness">
<h1>Representativeness<a class="headerlink" href="#Representativeness" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Specific Libraries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dqm.representativeness.metric</span><span class="w"> </span><span class="kn">import</span> <span class="n">DistributionAnalyzer</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[03-28 15:55:04] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\representativeness\twe_logger.py:102} INFO      - Logger: twe_logger, handlers: [&lt;StreamHandler stdout (DEBUG)&gt;]
[03-28 15:55:04] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\representativeness\twe_logger.py:102} INFO      - Logger: twe_logger, handlers: [&lt;StreamHandler stdout (DEBUG)&gt;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;blur_level&quot;</span><span class="p">]</span> <span class="c1"># you can choose another variable from the data.</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="c1"># data = pd.Series(np.random.normal(0, 1, 1000))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1650.9658847770813 946.0829447223126
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters for analysis</span>
<span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">distribution</span> <span class="o">=</span> <span class="s1">&#39;normal&#39;</span>

<span class="c1"># Instantiation of DistributionAnalyzer</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">DistributionAnalyzer</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">distribution</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[03-28 15:55:05] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\representativeness\twe_logger.py:102} INFO      - Logger: twe_logger, handlers: [&lt;StreamHandler stdout (DEBUG)&gt;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the method chisquare_test</span>
<span class="n">pvalue</span><span class="p">,</span> <span class="n">intervals_frequencies</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">chisquare_test</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-Square Test: p-value = </span><span class="si">{</span><span class="n">pvalue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-Square Test: discretized intervalls are </span><span class="se">\n</span><span class="s2"> = </span><span class="si">{</span><span class="n">intervals_frequencies</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[03-28 15:55:07] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\representativeness\metric.py:170} INFO      - pvalue = 0.0 &lt; 0.05: Data is not following the normal distribution
Chi-Square Test: p-value = 0.0
Chi-Square Test: discretized intervalls are
 =     lower_limit  upper_limit  obs_freq  exp_freq
0          -inf    94.797922       7.0    1209.0
1     94.797922   438.511806    1406.0    1108.0
2    438.511806   670.413932    1274.0    1168.0
3    670.413932   854.722390    2869.0    1065.0
4    854.722390  1012.842636    2083.0    1120.0
5   1012.842636  1154.839504    1025.0    1105.0
6   1154.839504  1286.420763     723.0    1127.0
7   1286.420763  1411.278511     621.0    1119.0
8   1411.278511  1532.079828     618.0    1123.0
9   1532.079828  1650.965885     847.0    1145.0
10  1650.965885  1769.851942    1309.0    1082.0
11  1769.851942  1890.653258    1646.0    1118.0
12  1890.653258  2015.511006    1460.0    1193.0
13  2015.511006  2147.092266    1182.0    1161.0
14  2147.092266  2289.089134     897.0    1122.0
15  2289.089134  2447.209380     708.0    1127.0
16  2447.209380  2631.517838     711.0    1126.0
17  2631.517838  2863.419964     806.0    1205.0
18  2863.419964  3207.133848     935.0    1163.0
19  3207.133848          inf    1626.0    1167.0
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the method kolmogorov</span>
<span class="n">ks_pvalue</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">kolmogorov</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span><span class="n">std</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kolmogorov-Smirnov Test: p-value = </span><span class="si">{</span><span class="n">ks_pvalue</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
par dist (np.float64(1650.9658847770813), np.float64(946.0829447223126))
[03-28 15:56:05] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\representativeness\metric.py:227} INFO      - KstestResult(statistic=np.float64(0.08743767587843615), pvalue=np.float64(8.40127378157898e-152), statistic_location=np.float64(1038.29640591), statistic_sign=np.int8(1))
[03-28 15:56:05] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\representativeness\metric.py:230} INFO      - p-value = 8.40127378157898e-152 &lt; 0.05 : The data is not followingthe normal distribution
Kolmogorov-Smirnov Test: p-value = 8.40127378157898e-152
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the method shannon_entropy</span>
<span class="n">entropy</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">shannon_entropy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shannon Entropy: </span><span class="si">{</span><span class="n">entropy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Shannon Entropy: 2.9951117507101492
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the method grte</span>
<span class="n">grte_result</span><span class="p">,</span> <span class="n">intervals_discretized</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">grte</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GRTE: </span><span class="si">{</span><span class="n">grte_result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1">#print(f&quot;GRTE discretized intervalls are \n = {intervals_discretized}&quot;) # uncomment to display data discretization</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
GRTE: 0.7474979873526185
</pre></div></div>
</div>
</section>
<section id="Diversity-test">
<h1>Diversity test<a class="headerlink" href="#Diversity-test" title="Link to this heading">ÔÉÅ</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># specifion Libraries</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dqm.diversity.metric</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiversityIndexCalculator</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metric_calculator</span> <span class="o">=</span> <span class="n">DiversityIndexCalculator</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simpson index</span>
<span class="n">metric_calculator</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;luminosity_level&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9999999729560708
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gini-Simpson Index</span>
<span class="n">metric_calculator</span><span class="o">.</span><span class="n">gini</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;luminosity_level&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9999560227089405
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dqm.diversity.diversity</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiversityCalculator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dqm.diversity.metric</span><span class="w"> </span><span class="kn">import</span> <span class="n">DiversityIndexCalculator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dqm.diversity.twe_logger</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_logger</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DataDiversityAnalyzer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for analyzing the diversity of datasets.</span>

<span class="sd">    This class integrates with DiversityCalculator and DiversityIndexCalculator</span>
<span class="sd">    to compute and analyze various diversity indices within a dataset. It provides</span>
<span class="sd">    methods to calculate and report diversity scores for specific features, aiding</span>
<span class="sd">    in understanding the distribution and representation in datasets.</span>

<span class="sd">    Methods:</span>
<span class="sd">        calculate_diversity_scores(data, feature): Calculates and logs the</span>
<span class="sd">            diversity scores for a given feature.</span>
<span class="sd">        none_function(): A placeholder method that currently does nothing.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the DataDiversityAnalyzer with necessary components.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            metric_calculator (DiversityIndexCalculator): Calculator for diversity indices.</span>
<span class="sd">            calculator (DiversityCalculator): Calculator for general diversity metrics.</span>
<span class="sd">            logger (Logger): Logger for logging information during the analysis.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metric_calculator</span> <span class="o">=</span> <span class="n">DiversityIndexCalculator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculator</span> <span class="o">=</span> <span class="n">DiversityCalculator</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">get_logger</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_diversity_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">feature</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate diversity scores for a given feature in the dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (pandas.DataFrame): The dataset containing the feature.</span>
<span class="sd">            feature (str): The feature for which diversity scores are calculated.</span>

<span class="sd">        Returns: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#self.logger.info(&quot;The first 5 lines of the data:&quot;)</span>
        <span class="c1">#self.logger.info(data.head())</span>
        <span class="c1">#self.logger.info(&quot;Data shape:&quot;)</span>
        <span class="c1">#self.logger.info(data.shape)</span>
        <span class="c1">#self.logger.info(&quot;Columns:&quot;)</span>
        <span class="c1">#self.logger.info(data.columns)</span>
        <span class="c1">#self.logger.info(&quot;Columns types:&quot;)</span>
        <span class="c1">#self.logger.info(data.dtypes)</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric_calculator</span><span class="o">.</span><span class="n">simpson</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Simpson index: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metric_calculator</span><span class="o">.</span><span class="n">gini</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Gini index: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>

        <span class="n">diversity_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculator</span><span class="o">.</span><span class="n">compute_diversity</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">],</span> <span class="s1">&#39;lexical&#39;</span><span class="p">,</span> <span class="s1">&#39;richness&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Diversity score: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">diversity_score</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">none_function</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A placeholder function that currently performs no operation.</span>

<span class="sd">        Returns: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Do not something&quot;</span><span class="p">)</span>
<br/><br/><br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[03-28 15:56:28] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\diversity\twe_logger.py:104} INFO      - Logger: twe_logger, handlers: [&lt;StreamHandler stdout (DEBUG)&gt;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use of DataDiversityAnalyzer Class</span>
<span class="n">analyzer</span> <span class="o">=</span> <span class="n">DataDiversityAnalyzer</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;datasets/challenge_welding.csv&quot;</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="c1">#feature_name = &quot;Traffic_light_green&quot;</span>
<span class="c1">#analyzer.calculate_diversity_scores(df, feature_name)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;bool&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For </span><span class="si">{</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="si">}</span><span class="s2"> feature :&quot;</span><span class="p">)</span>
        <span class="n">analyzer</span><span class="o">.</span><span class="n">calculate_diversity_scores</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;---------------------------------------------------------&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[03-28 16:01:40] {C:\SAUVEGARDES_FIN_CONFIANCE\FONDATION\Support_composants\env-dqm-NG\Lib\site-packages\dqm\diversity\twe_logger.py:104} INFO      - Logger: twe_logger, handlers: [&lt;StreamHandler stdout (DEBUG)&gt;]
For blur_level feature :
[03-28 16:01:40] {C:\Users\josquin.foulliaron\AppData\Local\Temp\ipykernel_29424\3773604603.py:56} INFO      - Simpson index: 1.0
[03-28 16:01:40] {C:\Users\josquin.foulliaron\AppData\Local\Temp\ipykernel_29424\3773604603.py:59} INFO      - Gini index: 0.9999560497516811
[03-28 16:01:40] {C:\Users\josquin.foulliaron\AppData\Local\Temp\ipykernel_29424\3773604603.py:62} INFO      - Diversity score: 10.032452283817129
---------------------------------------------------------
For luminosity_level feature :
[03-28 16:01:40] {C:\Users\josquin.foulliaron\AppData\Local\Temp\ipykernel_29424\3773604603.py:56} INFO      - Simpson index: 0.9999999729560708
[03-28 16:01:40] {C:\Users\josquin.foulliaron\AppData\Local\Temp\ipykernel_29424\3773604603.py:59} INFO      - Gini index: 0.9999560227089405
[03-28 16:01:40] {C:\Users\josquin.foulliaron\AppData\Local\Temp\ipykernel_29424\3773604603.py:62} INFO      - Diversity score: 10.03202578794723
---------------------------------------------------------
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">index</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">index_in</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">requirement_welding_seams</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;c102&quot;</span><span class="p">,</span><span class="s2">&quot;c20&quot;</span><span class="p">,</span> <span class="s2">&quot;c33&quot;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">relative_diversity</span> <span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">requirements</span><span class="p">):</span>
    <span class="n">index_in</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">requirements</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">variable</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">index_in</span> <span class="o">+=</span><span class="mi">1</span>

    <span class="n">Relative_diversity_score</span> <span class="o">=</span> <span class="n">index_in</span> <span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">requirement_camera</span><span class="p">)</span><span class="o">-</span><span class="n">index_in</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Relative_diversity_score</span>
<span class="c1">#Relative_diversity</span>

<span class="n">relative_diversity</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;welding-seams&quot;</span><span class="p">],</span> <span class="n">requirement_welding_seams</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
class
OK    22259
KO      494
Name: count, dtype: int64
c102
c20
c33
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
np.float64(1.5)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, IRT SystemX.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>